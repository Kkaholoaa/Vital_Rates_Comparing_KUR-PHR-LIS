---
title: "VitalRateFunctions"
author: "Caroline Rodriguez"
date: "1/25/2021"
output: html_document
---

#Libraries
```{r}
library(ggplot2)
library(plyr)
library(dplyr)
library(tidyr)
```

#Set up
```{r}
setwd("/Users/c-rod/Documents/R_data/VitalRates/")
#load in .rdata file
load(file = "/Users/c-rod/Documents/R_data/VitalRates/Patch_And_Colony_Data_20201103.rdata")

View(ColonyLevel)
#View(PatchLevel)


```

#Subset by Site and Genus
Going to use ColonyLevel data to avoid all the fission/fusion confusion
```{r}
MAISIOK01 <- subset(ColonyLevel, Site=="MAI_SIO_K01")
#View(MAISIOK01)
KUROCC010 <- subset(ColonyLevel, Site=="KUR_OCC_010")
#View(KUROCC010)
PHROCC016 <- subset(ColonyLevel, Site=="PHR_OCC_016")
#View(PHROCC016)
HAWOCC002 <- subset(ColonyLevel, Site=="HAW_OCC_002")
HAWOCC003 <- subset(ColonyLevel, Site=="HAW_OCC_003")
HAWOCC010 <- subset(ColonyLevel, Site=="HAW_OCC_010")
HAWSIOK08 <- subset(ColonyLevel, Site=="HAW_SIO_K08")
HAWSIOK10 <- subset(ColonyLevel, Site=="HAW_SIO_K10")
MAIOCC002 <- subset(ColonyLevel, Site=="MAI_OCC_002")
OAH022 <- subset(ColonyLevel, Site=="OAH_XXX_022")
OAHOCC010 <- subset(ColonyLevel, Site=="OAH_OCC_010")


#separate by Genus
Poc <- subset(ColonyLevel, Genus_Code == "POCS")
Porites <- subset(ColonyLevel, Genus_Code == "POSP")
Montip <- subset(ColonyLevel, Genus_Code == "MOSP")

```

#Combined Growth Function
```{r}
#should we restrict data to colonies > 20cm2?

#plot starting size and ending size for growth. Get a best fit line for that data
allgrowth <- subset(ColonyLevel, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#View(allgrowth)

#plo <- ggplot(growth, aes(x=ln_SS, y=TransitionRate_L, shape=TransitionTypeSimple)) + 
  #geom_point(size=1) +
    #ylim(1,5)
#plo
#his <- hist(growth$StartingSize, breaks = 1000, xlim = c(0,50) )



#For growth function, will fit using starting vs ending size, log transformed because to exaggerate small differences (b/c I have so many little pieces and lots of instances of little growth)
growth_plot = ggplot(data = allgrowth, aes(x=ln_SS, y=ln_ES,color=TransitionTypeSimple,shape=TransitionTypeSimple)) + 
  geom_point() + geom_abline(slope = 1)+
  ggtitle("Growth: All Genera and All Sites") +
  #scale_x_sqrt(breaks=c(10,50,100,250,500,1000,2000),limits=c(0,400))+ #log transform x axis
  #scale_y_sqrt(breaks=c(10,50,100,250,500,1000,2000),limits=c(0,400))+
  scale_shape_manual(values=0:4)+
  theme_bw()+ #facet_grid separates by Genus Code (makes 3 verticle plots) and Site (makes horizontal plots)
  xlab("Colony Size at Time T (cm^2)") + ylab("Colony Size at Time T+1 (cm^2)")
growth_plot


fit_allgrowth <- lm(ln_ES ~ ln_SS ,data = allgrowth)
fit_allgrowth
summary(fit_allgrowth)
#linear model for just growth function y = 0.8846x + 0.3253
#linear model w/ growth & shrink y= 0.8846x + 0.3253
plot(ln_ES ~ ln_SS ,data = allgrowth, xlim=c(-3,10), ylim=c(-3,10), main = "Growth/Shrink: All Genera and All Sites", xlab = "Log Starting Size", ylab = "Log Ending Size")
abline(fit_allgrowth)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#smaller sizes grow faster and the larger sizes are right at the 1:1

```

#Growth function: separate by Genus
```{r}
#plot based on Genus
growth_plot_genus = ggplot(data = allgrowth, aes(x=ln_SS, y=ln_ES,color=TransitionTypeSimple,shape=TransitionTypeSimple)) + 
  geom_point() + geom_abline(slope = 1)+
  #scale_x_sqrt(breaks=c(10,50,100,250,500,1000,2000),limits=c(0,400))+ #log transform x axis
  #scale_y_sqrt(breaks=c(10,50,100,250,500,1000,2000),limits=c(0,400))+
  scale_shape_manual(values=0:4)+
  facet_grid(c("Genus_Code"))+theme_bw()+ #facet_grid separates by Genus Code (makes 3 verticle plots) and Site (makes horizontal plots)
  xlab("Colony Size at Time T (cm^2)") + ylab("Colony Size at Time T+1 (cm^2)")
growth_plot_genus


#Pocillopora
growth_POCS <- subset(Poc, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#View(growth_POCS) #202

#function
fit_POCS <- lm(ln_ES ~ ln_SS ,data = growth_POCS)
fit_POCS
summary(fit_POCS)
#linear model for growth function y = 0.6136 x + 2.2894
plot(ln_ES ~ ln_SS ,data = growth_POCS ,xlim=c(-3,10), ylim=c(-3,10), main="All Pocillopora growth at all sites" )  
abline(fit_POCS)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#everyone's growing and smaller sizes grow supa faster and the larger sizes are right at the 1:1


####################
#Porites
growth_POSP <- subset(Porites, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#View(growth_POSP)

#function
fit_POSP <- lm(ln_ES ~ ln_SS ,data = growth_POSP)
fit_POSP
#linear model for growth function y = 0.8527x + 0.3080
summary(fit_POSP)
plot(ln_ES ~ ln_SS ,data = growth_POSP ,xlim=c(-3,10), ylim=c(-3,10), main="All Porites growth at all sites")
abline(fit_POSP)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#smaller sizes grow faster and the larger sizes are right at the 1:1


####################
#Montipora
growth_MOSP <- subset(Montip, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#View(growth_MOSP)

#function
fit_MOSP <- lm(ln_ES ~ ln_SS ,data = growth_MOSP)
fit_MOSP
#linear model for growth function
#y = 0.8960x + 0.2839
summary(fit_MOSP)
plot(ln_ES ~ ln_SS ,data = growth_MOSP ,xlim=c(-3,10), ylim=c(-3,10), main="All Montipora growth at all sites")
abline(fit_MOSP)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)

#another way to plot (all montipora)
ggplot(growth_MOSP, aes(x=ln_SS, y=ln_ES))+ geom_point() + geom_smooth(method = lm)+
  ggtitle("All Montipora growth at all sites")+
  annotate("rect", xmin =-.5, xmax = .5, ymin = 4.5, ymax = 5.5, fill="white", colour="red") +
  annotate("text", x=0, y=5, label = "R^2=0.93") 
#smaller sizes grow faster and the larger sizes are right at the 1:1
```

#Growth function: separate by site, all genera
```{r}
#MAISIOK01
growth_MAISIOK01 <- subset(MAISIOK01, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_MAISIOK01 <- lm(ln_ES ~ ln_SS ,data = growth_MAISIOK01)
fit_MAISIOK01
summary(fit_MAISIOK01)
#plot
plot(ln_ES ~ ln_SS ,data = growth_MAISIOK01 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at MAISIOK01")
abline(fit_MAISIOK01)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_MAISIOK01)
#interpret results
anova(fit_MAISIOK01)

###################
#KUROCC010
growth_KUROCC010 <- subset(KUROCC010, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_KUROCC010 <- lm(ln_ES ~ ln_SS ,data = growth_KUROCC010)
fit_KUROCC010
summary(fit_KUROCC010)
#plot
plot(ln_ES ~ ln_SS ,data = growth_KUROCC010 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at KUROCC010") 
abline(fit_KUROCC010)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_KUROCC010)
#interpret results
anova(fit_KUROCC010)


###################
#PHROCC016
growth_PHROCC016 <- subset(PHROCC016, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_PHROCC016 <- lm(ln_ES ~ ln_SS ,data = growth_PHROCC016)
fit_PHROCC016
summary(fit_PHROCC016)
#plot
plot(ln_ES ~ ln_SS ,data = growth_PHROCC016 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at PHROCC016") 
abline(fit_PHROCC016)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_PHROCC016)
#interpret results
anova(fit_PHROCC016)

###################
#HAWOCC002 
growth_HAWOCC002 <- subset(HAWOCC002, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_HAWOCC002 <- lm(ln_ES ~ ln_SS ,data = growth_HAWOCC002)
fit_HAWOCC002
summary(fit_HAWOCC002)
#plot
plot(ln_ES ~ ln_SS ,data = growth_HAWOCC002 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at HAWOCC002") 
abline(fit_HAWOCC002)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_HAWOCC002)
#interpret results
anova(fit_HAWOCC002)

###################
#HAWOCC003
growth_HAWOCC003 <- subset(HAWOCC003, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_HAWOCC003 <- lm(ln_ES ~ ln_SS ,data = growth_HAWOCC003)
fit_HAWOCC003
summary(fit_HAWOCC003)
#plot
plot(ln_ES ~ ln_SS ,data = growth_HAWOCC003 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at HAWOCC003") 
abline(fit_HAWOCC003)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_HAWOCC003)
#interpret results
anova(fit_HAWOCC003)

###################
#HAWOCC010
growth_HAWOCC010 <- subset(HAWOCC010, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_HAWOCC010 <- lm(ln_ES ~ ln_SS ,data = growth_HAWOCC010)
fit_HAWOCC010
summary(fit_HAWOCC010)
#plot
plot(ln_ES ~ ln_SS ,data = growth_HAWOCC010 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at HAWOCC010") 
abline(fit_HAWOCC010)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_HAWOCC010)
#interpret results
anova(fit_HAWOCC010)

###################
#HAWSIOK08
growth_HAWSIOK08 <- subset(HAWSIOK08, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_HAWSIOK08 <- lm(ln_ES ~ ln_SS ,data = growth_HAWSIOK08)
fit_HAWSIOK08
summary(fit_HAWSIOK08)
#plot
plot(ln_ES ~ ln_SS ,data = growth_HAWSIOK08 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at HAWSIOK08") 
abline(fit_HAWSIOK08)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_HAWSIOK08)
#interpret results
anova(fit_HAWSIOK08)

###################
#HAWSIOK10
growth_HAWSIOK10 <- subset(HAWSIOK10, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_HAWSIOK10 <- lm(ln_ES ~ ln_SS ,data = growth_HAWSIOK10)
fit_HAWSIOK10
summary(fit_HAWSIOK10)
#plot
plot(ln_ES ~ ln_SS ,data = growth_HAWSIOK10 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at HAWSIOK10") 
abline(fit_HAWSIOK10)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_HAWSIOK10)
#interpret results
anova(fit_HAWSIOK10)

###################
#MAIOCC002
growth_MAIOCC002 <- subset(MAIOCC002, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_MAIOCC002 <- lm(ln_ES ~ ln_SS ,data = growth_MAIOCC002)
fit_MAIOCC002
summary(fit_MAIOCC002)
#plot
plot(ln_ES ~ ln_SS ,data = growth_MAIOCC002 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at MAIOCC002") 
abline(fit_MAIOCC002)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_MAIOCC002)
#interpret results
anova(fit_MAIOCC002)

###################
#OAH022
growth_OAH022 <- subset(OAH022, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_OAH022 <- lm(ln_ES ~ ln_SS ,data = growth_OAH022)
fit_OAH022
summary(fit_OAH022)
#plot
plot(ln_ES ~ ln_SS ,data = growth_OAH022 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at OAH022") 
abline(fit_OAH022)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_OAH022)
#interpret results
anova(fit_OAH022)

###################
#OAHOCC010
growth_OAHOCC010 <- subset(OAHOCC010, TransitionTypeSimple == "GROWTH" | TransitionTypeSimple == "SHRINK")
#function
fit_OAHOCC010 <- lm(ln_ES ~ ln_SS ,data = growth_OAHOCC010)
fit_OAHOCC010
summary(fit_OAH022)
#plot
plot(ln_ES ~ ln_SS ,data = growth_OAH022 ,xlim=c(-3,10), ylim=c(-3,10), main="All genera growth at OAHOCC010") 
abline(fit_OAH022)
abline(a=0, b=1,col="red")
legend("topleft", bty = "n", lty = c(1,1), col = c("black","red"),
       legend=c("model fit", "1:1"), cex = 0.8)
#plot residuals
par(mfrow=c(2,2))
plot(fit_OAH022)
#interpret results
anova(fit_OAH022)

```

#Growth by Site and Genus (need to finish)
one site, separate by genera
```{r}
#MAISIOK01
gro_MAISIOK01_POSP <- subset(growth_MAISIOK01, Genus_Code == "POSP")
#function
fit_MAISIOK01_POSP <- lm(ln_ES ~ ln_SS ,data = gro_MAISIOK01_POSP)
fit_MAISIOK01_POSP
#linear model for growth function:  y = 0.9182x + 0.5546
#plot
summary(fit_MAISIOK01_POSP)
plot(ln_ES ~ ln_SS ,data = gro_MAISIOK01_POSP ,xlim=c(-3,10), ylim=c(-3,10), main="Porites growth at MAISIOK01")
abline(fit_MAISIOK01_POSP)
abline(a=0, b=1,col="red")
#plot residuals
par(mfrow=c(2,2))
plot(fit_MAISIOK01_POSP)
#interpret results
anova(fit_MAISIOK01_POSP)
 

```


Compare r2 values
Do a likliehood or AIC comparison to compare model fit and determine the best one?
#AIC comparison
https://www.scribbr.com/statistics/akaike-information-criterion/
```{r}
#Going to compare genus model vs. site model vs. site+genus
fit_POCS
fit_MAISIOK01
fit_MAISIOK01_POSP

```



#Survival (Mortality) function
Use binomial to fit
```{r Survival, cache=FALSE}
## Starting with suvival/mortality of all (genera + site + year)

# s.mod <- glm(surv ~ area + area_2, family="binomial", data)

# genera <- # Particular genus name we care about
# genz <- ColonyLevel[ColonyLevel$Genus_Code == genera]
# d_site <- # site name
# sitez <- ColonyLevel
# a_data_mort <- subset(ColonyLevel, TransitionTypeSimple == "MORT") 
# ps <- subset(a_data_mort, Genus_Code == "POSP")

#all survival (all sites all genera)
surv <- 1 - ColonyLevel$Mortality
ColonyLevel$ln_SS <- as.numeric(ColonyLevel$ln_SS)
ColonyLevel$ln_SS[ColonyLevel$ln_SS == -Inf] <-NA
#fit
gn <- glm(surv ~ ln_SS, family = "binomial", data = ColonyLevel)
gn
inv.logit <- function(x){
  exp(x)/(1+exp(x))
}

#plot(ColonyLevel$ln_SS, surv, xlab = 'Area (ln of area)', ylab = 'Survival')
# This isn't really showing anything...

#better plot
plot(jitter(surv, 0.1) ~ ln_SS, ColonyLevel)
ss <- seq(-3, 9, 0.1)
lines(ss, predict(gn, list(ln_SS = ss), type="response"), pch=8)
# this will give the original response variable -- don't need to do the reverse transform, works for any type of glm.



#survival by genus
####################
#Pocillopora
surv_POCS <- 1 - Poc$Mortality
Poc$ln_SS <- as.numeric(Poc$ln_SS)
Poc$ln_SS[Poc$ln_SS == -Inf] <-NA
#fit
gn_POCS <- glm(surv_POCS ~ ln_SS, family = "binomial", data = Poc)
gn_POCS
inv.logit <- function(x){
  exp(x)/(1+exp(x))
}
#plot
plot(jitter(surv_POCS, 0.1) ~ ln_SS, Poc)
ss <- seq(-3, 9, 0.1)
lines(ss, predict(gn_POCS, list(ln_SS = ss), type="response"), pch=8)


####################
#Porites
surv_POSP <- 1 - Porites$Mortality
Porites$ln_SS <- as.numeric(Porites$ln_SS)
Porites$ln_SS[Porites$ln_SS == -Inf] <-NA
#fit
gn_POSP <- glm(surv_POSP ~ ln_SS, family = "binomial", data = Porites)
gn_POSP
inv.logit <- function(x){
  exp(x)/(1+exp(x))
}
#plot
plot(jitter(surv_POSP, 0.1) ~ ln_SS, Porites)
ss <- seq(-3, 9, 0.1)
lines(ss, predict(gn_POSP, list(ln_SS = ss), type="response"), pch=8)


####################
#Montipora
surv_MOSP <- 1 - Montip$Mortality
Montip$ln_SS <- as.numeric(Montip$ln_SS)
Montip$ln_SS[Montip$ln_SS == -Inf] <-NA
#fit
gn_MOSP <- glm(surv_MOSP ~ ln_SS, family = "binomial", data = Montip)
gn_MOSP
inv.logit <- function(x){
  exp(x)/(1+exp(x))
}
#plot
plot(jitter(surv_MOSP, 0.1) ~ ln_SS, Montip)
ss <- seq(-3, 9, 0.1)
lines(ss, predict(gn_MOSP, list(ln_SS = ss), type="response"), pch=8)

```


#Reproduction
The # of recruits
```{r}
recruitment <- subset(ColonyLevel, TransitionTypeSimple == "RECR")
#View(recruitment)
recrhist <- hist(recruitment$ln_ES, breaks = 100)


#number of recruits per transition (number recruits/interval year)
#plot(recruitment, xlab = Interval_Years, ylab = Recruit)
#sum the recruits
#total
sumrecruit<- sum(recruitment$Recruit)

iy <- unique(recruitment$Interval_Years)
iy

yearish <- rep(0,length(iy)) #initalize vector
#for every interval year, get the sum of recruits for that interval year
for (v in 1:length(iy)) {
  yearish[v] <- sum(recruitment$Recruit[which(recruitment$Interval_Years== iy[v])])
}
yearish <- round(yearish/iy) #normalizes by year (# of recruits/year)
yearish

#separate by genus

#Pocillopora
recr_POCS <- subset(recruitment, Genus_Code == "POCS")
#POCS_recr_hist <- hist(recr_POCS$ln_ES, breaks = 100)
iy <- unique(recr_POCS$Interval_Years)
iy
yearish_POCS <- rep(0,length(iy)) #initalize vector
#for every interval year, get the sum of recruits for that interval year
for (v in 1:length(iy)) {
  yearish_POCS[v] <- sum(recr_POCS$Recruit[which(recr_POCS$Interval_Years== iy[v])])
}
yearish_POCS <- round(yearish_POCS/iy) #normalizes by year (# of recruits/year)
yearish_POCS

avg_rPOCS <- round(mean(yearish_POCS))
#4

#porites
recr_POSP <- subset(recruitment, Genus_Code == "POSP")
#POSP_recr_hist <- hist(recr_POSP$ln_ES, breaks = 100)


#montipora
recr_MOSP <- subset(recruitment, Genus_Code == "MOSP")
#MOSP_recr_hist <- hist(recr_MOSP$ln_ES, breaks = 100)



```



Caroline's to-do list:
  -separate whole dataset by genus
  -clean up
growth:
  -slope and intercept for each genus
survival:
  -slope and intercept for each genus 
reproduction: 
  -calculate total coral area from previous timepoint. Then take # recruits/total area. Take yearish/previous area
  -separate by each genus
create dataframe: 
  -slope and intercept for each genus for each demographic parameter


Devynn's To do list:
-Change parameterization of enviro variance so it depends on pheno variance (so model will only depend on )
-Start powerpoint
-Run through scenarios that we care about (ideas: AGF, supportive breeding, outplanting, outcrossing, algal symbiont manipulation)
-Once have Caroline's data, check lambda values for each taxa
-If lambda <1, boost recruitment


